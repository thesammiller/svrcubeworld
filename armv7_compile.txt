ANDROID_ABI=armeabi-v7a
# ANDROID_NDK=/Users/.../Library/Android/sdk/ndk/20.1.5948944
ANDROID_NDK=/Users/.../Library/Android/sdk/ndk/14.1.3816874

BUILD_TYPE=Release

build_dir=build-android-${ANDROID_ABI}

mkdir -p ${build_dir}
cd ${build_dir}

# Add the following contents to CMakeLists.txt
# set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -Wno-unused-command-line-argument")
# set(CMAKE_CXX_FLAGS_RELEASE "-O3 -DNDEBUG")

cmake .. \
    -DCMAKE_INSTALL_PREFIX=./ \
    -DCMAKE_BUILD_TYPE=${BUILD_TYPE} \
    -DCMAKE_TOOLCHAIN_FILE=${ANDROID_NDK}/build/cmake/android.toolchain.cmake \
    -DANDROID_ABI=${ANDROID_ABI} \
    -DANDROID_ARM_NEON=ON \
    -DANDROID_PLATFORM=android-21 \
    -DCMAKE_ANDROID_NDK_TOOLCHAIN_VERSION=clang \
    -DANDROID_TOOLCHAIN=clang \
    -DANDROID_STL=c++_static \
    -DARCH=arm \
    -DISA_NEON=ON \
    -DUNITTEST=ON

make -j16
